<html>
    <head>
        <script
            type="text/javascript"
            src="../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Classe utilizada para conx&atilde;o com o Bando de Dados.
 * 
 * @author Jefferson Uchoa Ponte
 * @version 1.0
 * @copyright UNILAB - Universidade da Integracao Internacional da Lusofonia Afro-Brasileira.
 * @package DAO
 */

/**
 * Nesta classe s&atilde;o realizadas as conex&otilde;es com o Banco de Dados,
 * com refer&ecirc;ncia ao tratamento de dados relativos a entidade Cart&otilde;es.
 *
 * Nela &eacute; realizada Consulta, Inser&ccedil;&atilde;o, Atualiza&ccedil;&atilde;o e Exclus&atilde;o dos cart&otilde;es.
 */
class CartaoDAO extends DAO {
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para realizar pesquisa pelo n&uacute;mero do cart&atilde;o,
	 * retorna um array contendo os dados do usu&aacute;rios, relativo ao cart&atilde;o consultado.
	 *
	 * @param string $numero
	 *        	N&uacute;mero do cart&atilde;o.
	 * @return Cartao[] Array contendo a consulta.
	 */
	public function pesquisaPorNumero($numero) {
		$numero = preg_replace ( '/[^0-9]/', '', $numero );
		$lista = array ();
		
		$sql = &quot;SELECT * FROM cartao 
		INNER JOIN tipo ON cartao.tipo_id = tipo.tipo_id 
		WHERE cart_numero = '$numero' LIMIT 100&quot;;
		foreach ( $this-&gt;getConexao ()-&gt;query ( $sql ) as $linha ) {
			$cartao = new Cartao ();
			$cartao-&gt;setId ( $linha ['cart_id'] );
			$cartao-&gt;setCreditos ( $linha ['cart_creditos'] );
			$cartao-&gt;setNumero ( $linha ['cart_numero'] );
			$tipo = new Tipo ();
			$tipo-&gt;setId ( $linha ['tipo_id'] );
			$tipo-&gt;setNome ( $linha ['tipo_nome'] );
			$tipo-&gt;setValorCobrado ( $linha ['tipo_valor'] );
			$cartao-&gt;setTipo ( $tipo );
			$lista [] = $cartao;
		}
		return $lista;
	}
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para realizar pesquisa pelo n&uacute;mero do cart&atilde;o,
	 * retorna um Objeto Cart&atilde;o contendo os dados do usu&aacute;rios, relativo ao cart&atilde;o consultado.
	 *
	 * @param Cartao $cartao
	 *        	Objeto os dados do Cart&atilde;o.
	 * @return Cartao Objeto Cart&atilde;o contendo os dados do cart&atilde;o consultado.
	 */
	public function preenchePorNumero(Cartao $cartao) {
		$numero = $cartao-&gt;getNumero ();
		$sql = &quot;SELECT * FROM cartao
		INNER JOIN tipo ON cartao.tipo_id = tipo.tipo_id
		WHERE cart_numero = '$numero' LIMIT 100&quot;;
		
		foreach ( $this-&gt;getConexao ()-&gt;query ( $sql ) as $linha ) {
			
			$cartao-&gt;setId ( $linha ['cart_id'] );
			$cartao-&gt;setCreditos ( $linha ['cart_creditos'] );
			$cartao-&gt;setNumero ( $linha ['cart_numero'] );
			$tipo = new Tipo ();
			$tipo-&gt;setId ( $linha ['tipo_id'] );
			$tipo-&gt;setNome ( $linha ['tipo_nome'] );
			$tipo-&gt;setValorCobrado ( $linha ['tipo_valor'] );
			$cartao-&gt;setTipo ( $tipo );
			return $cartao;
		}
		return null;
	}
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para consultar todos os tipos cadastrados,
	 * retorna um array contendo as informa&ccedil;&otilde;es.
	 *
	 * @return Tipo[] Array contendo os tipos.
	 */
	public function retornaTipos() {
		$lista = array ();
		$result = $this-&gt;getConexao ()-&gt;query ( &quot;SELECT * FROM tipo&quot; );
		
		foreach ( $result as $linha ) {
			$tipo = new Tipo ();
			$tipo-&gt;setId ( $linha ['tipo_id'] );
			$tipo-&gt;setNome ( $linha ['tipo_nome'] );
			$lista [] = $tipo;
		}
		return $lista;
	}
	
	/**
	 * Retorna uma lista de cart&otilde;es.
	 *
	 * @return Cartao[] Array contendo todos os cart&otilde;es e seus respectivos Tipos.
	 */
	public function retornaLista() {
		$lista = array ();
		$result = $this-&gt;getConexao ()-&gt;query ( &quot;SELECT * FROM cartao INNER JOIN tipo ON cartao.tipo_id = tipo.tipo_id LIMIT 100&quot; );
		
		foreach ( $result as $linha ) {
			$cartao = new Cartao ();
			$cartao-&gt;setId ( $linha ['cart_id'] );
			$cartao-&gt;setCreditos ( $linha ['cart_creditos'] );
			$cartao-&gt;setNumero ( $linha ['cart_numero'] );
			$tipo = new Tipo ();
			$tipo-&gt;setId ( $linha ['tipo_id'] );
			$tipo-&gt;setNome ( $linha ['tipo_nome'] );
			$tipo-&gt;setValorCobrado ( $linha ['tipo_valor'] );
			$cartao-&gt;setTipo ( $tipo );			
			$lista [] = $cartao;
		}
		return $lista;
	}
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para realizar a inser&ccedil;&atilde;o de um cart&atilde;o novo,
	 * retorna True caso a inser&ccedil;&atilde;o seja realizada.
	 *
	 * @param Cartao $cartao
	 *        	Cart&atilde;o sem venculo a ser cadastrado.
	 * @return boolean True caso a inser&ccedil;&atilde;o seja bem sussedida.
	 */
	public function inserir(Cartao $cartao) {
		$numero = $cartao-&gt;getNumero ();
		$idTipo = $cartao-&gt;getTipo ()-&gt;getId ();
		
		if ($this-&gt;getConexao ()-&gt;query ( &quot;INSERT INTO cartao(cart_numero, cart_creditos, tipo_id) VALUES($numero, 0, $idTipo)&quot; ))
			return true;
		return false;
	}
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para deletar uma unidade,
	 * retorna True caso o delete seja realizado.
	 *
	 * @param Unidade $unidade
	 *        	Unidade a ser exclu&iacute;da.
	 * @return boolean True caso a exclus&atilde;o seja bem sucedida.
	 */
	public function deletarUnidade(Unidade $unidade) {
		$id = $unidade-&gt;getId ();
		$sql = &quot;DELETE FROM unidade WHERE unid_id = $id&quot;;
		if ($this-&gt;getConexao ()-&gt;query ( $sql ))
			return true;
		return false;
	}
	
	/**
	 * Passe um Objeto cartao com ID e receba-o preenchido.
	 *
	 * @param Cartao $cartao
	 *        	Cart&atilde;o a ser consultado.
	 * @return Cartao Objeto Cart&atilde;o contendo os dados do cart&atilde;o consultado.
	 */
	public function selecionaPorId(Cartao $cartao) {
		$id = $cartao-&gt;getId ();
		$id = intval ( $id );
		$sql = &quot;SELECT * FROM cartao INNER JOIN tipo ON cartao.tipo_id = tipo.tipo_id WHERE cart_id = $id LIMIT 1&quot;;
		foreach ( $this-&gt;getConexao ()-&gt;query ( $sql ) as $linha ) {
			
			$cartao-&gt;setId ( $linha ['cart_id'] );
			$cartao-&gt;setCreditos ( $linha ['cart_creditos'] );
			$cartao-&gt;setNumero ( $linha ['cart_numero'] );
			$tipo = new Tipo ();
			$tipo-&gt;setId ( $linha ['tipo_id'] );
			$tipo-&gt;setNome ( $linha ['tipo_nome'] );
			$tipo-&gt;setValorCobrado ( $linha ['tipo_valor'] );
			$cartao-&gt;setTipo ( $tipo );
			return $cartao;
		}
	}
}

?&gt;</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>