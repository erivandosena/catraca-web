<html>
    <head>
        <script
            type="text/javascript"
            src="../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Classe utilizada para centralizar as demais Classes(DAO, Model, View, Util).
 * Esta classe ser&aacute; instaciada no index.php.
 * 
 * @author Jefferson Uchoa Ponte
 * @version 1.0
 * @copyright UNILAB - Universidade da Integracao Internacional da Lusofonia Afro-Brasileira.
 * @package Controle
 */
/**
 * Classe respons&aacute;vel pelo cadastrado de novos cart&otilde;es, verifica&ccedil;&atilde;o e atualiza&ccedil;&atilde;o de vinculos.
 */
class CartaoController {
	
	/**
	 *
	 * @access private
	 * @var CartaoView para instaciar classes do pacote View.
	 * @name $view
	 */
	private $view;
	
	/**
	 * Metodo principal utilizada para controlar o acesso a classe atrav&eacute;s do n&iacute;vel de acesso do usuario.
	 *
	 * @param Sessao $nivelDeAcesso
	 *        	Recebe uma Sess&atilde;o que cont&eacute;m o n&iacute;vel de acesso do usuario.
	 */
	public static function main($nivelDeAcesso) {
		switch ($nivelDeAcesso) {
			case Sessao::NIVEL_SUPER :
				$controller = new CartaoController ();
				$controller-&gt;telaCartao ();
				break;
			case Sessao::NIVEL_ADMIN :
				$controller = new CartaoController ();
				$controller-&gt;telaCartao ();
				break;
			case Sessao::NIVEL_GUICHE :
				$controller = new CartaoController ();
				$controller-&gt;telaCartao ();
				break;
			case Sessao::NIVEL_POLIVALENTE :
				$controller = new CartaoController ();
				$controller-&gt;telaCartao ();
				break;
			case Sessao::NIVEL_CADASTRO :
				$controller = new CartaoController ();
				$controller-&gt;telaCartao ();
				break;
			case Sessao::NIVEL_CATRACA_VIRTUAL :
				$controller = new CartaoController ();
				$controller-&gt;telaCartao ();
				break;
			default :
				UsuarioController::main ( $nivelDeAcesso );
				break;
		}
	}
	
	/**
	 * Exibe a tela principal da p&aacute;gina Cart&atilde;o.
	 * Contem duas abas &aacute;ra consulta pelo cart&atilde;o e outra pelo nome do usu&aacute;rio.
	 */
	public function telaCartao() {
		$this-&gt;view = new CartaoView ();
		echo '&lt;div class = &quot;simpleTabs&quot;&gt;
			        &lt;ul class = &quot;simpleTabsNavigation&quot;&gt;					
						&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Identifica&amp;ccedil;&amp;atilde;o&lt;/a&gt;&lt;/li&gt;
						&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Cadastro&lt;/a&gt;&lt;/li&gt;						
			        &lt;/ul&gt;
		        &lt;div class = &quot;simpleTabsContent&quot;&gt;';
		
		$this-&gt;telaIdentificacao ();
		echo '	&lt;/div&gt;
				&lt;div class = &quot;simpleTabsContent&quot;&gt;';
		$this-&gt;telaCadastro ();
		echo '	&lt;/div&gt;		
						
		    &lt;/div&gt;';
	}
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para gerar a tela para pesquisa pelo n&uacute;mero do cart&atilde;o do usu&aacute;rio.
	 * Esta tela pode ser utilizada para renovar o vinculo do cart&atilde;o.
	 */
	public function telaIdentificacao() {
		$this-&gt;view-&gt;formBuscaCartao ();
		
		if (isset ( $_GET ['numero_cartao'] )) {
			if (strlen ( $_GET ['numero_cartao'] ) &gt; 3) {
				
				$cartao = new Cartao ();
				$cartao-&gt;setNumero ( $_GET ['numero_cartao'] );
				$numeroCartao = $cartao-&gt;getNumero ();
				$dataTimeAtual = date ( &quot;Y-m-d G:i:s&quot; );
				$sqlVerificaNumero = &quot;SELECT * FROM usuario
				INNER JOIN vinculo
				ON vinculo.usua_id = usuario.usua_id
				LEFT JOIN cartao ON cartao.cart_id = vinculo.cart_id
				LEFT JOIN tipo ON cartao.tipo_id = tipo.tipo_id
				WHERE cartao.cart_numero = '$numeroCartao'
				&quot;;
				$dao = new DAO ();
				$result = $dao-&gt;getConexao ()-&gt;query ( $sqlVerificaNumero );
				$idCartao = 0;
				$usuario = new Usuario ();
				$tipo = new Tipo ();
				$vinculoDao = new VinculoDAO ( $dao-&gt;getConexao () );
				$vinculo = new Vinculo ();
				foreach ( $result as $linha ) {
					$idDoVinculo = $linha ['vinc_id'];
					$tipo-&gt;setNome ( $linha ['tipo_nome'] );
					$usuario-&gt;setNome ( $linha ['usua_nome'] );
					$usuario-&gt;setIdBaseExterna ( $linha ['id_base_externa'] );
					$idCartao = $linha ['cart_id'];
					$vinculo-&gt;setAvulso ( $linha ['vinc_avulso'] );
					$avulso = $linha ['vinc_avulso'];
					if ($avulso) {
						$usuario-&gt;setNome ( &quot;Avulso&quot; );
					}
					break;
				}
				
				if ($idCartao) {
					
					$vinculo-&gt;setId ( $idDoVinculo );
					$cartao-&gt;setId ( $idCartao );
					$vinculoDao-&gt;vinculoPorId ( $vinculo );
					$imagem = null;
					
					if (file_exists ( 'fotos/' . $usuario-&gt;getIdBaseExterna () . '.png' )) {
						$imagem = $usuario-&gt;getIdBaseExterna ();
					} else {
						$imagem = &quot;sem-imagem&quot;;
					}
					
					if (! $vinculo-&gt;isActive ()) {
						echo '&lt;div id=&quot;pergunta&quot;&gt;';
						$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;vinculo n&Atilde;&pound;o est&Atilde;&iexcl; ativo.&quot; );
						echo '	&lt;a href=&quot;?pagina=cartao&amp;numero_cartao=' . $_GET ['numero_cartao'] . '&amp;cartao_renovar=1&quot; class=&quot;botao&quot;&gt;Renovar&lt;/a&gt;
							&lt;/div&gt;';
						if (isset ( $_GET ['cartao_renovar'] )) {
							if (isset ( $_POST ['certeza'] )) {
								$usuarioDao = new UsuarioDAO ();
								
								$usuarioDao-&gt;retornaPorIdBaseExterna ( $usuario );
								
								if ($vinculoDao-&gt;usuarioJaTemVinculo ( $usuario )) {
									$this-&gt;view-&gt;formMensagem ( &quot;-ajuda&quot;, &quot;Esse usu&Atilde;&iexcl;rio j&Atilde;&iexcl; possui v&Atilde;&shy;nculo v&Atilde;&iexcl;lido.&quot; );
									echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;4; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
									return;
								}
								if ($vinculo-&gt;isAvulso ()) {
									$this-&gt;view-&gt;formMensagem ( &quot;-ajuda&quot;, &quot;N&Atilde;&pound;o existe renova&Atilde;&sect;&Atilde;&pound;o de v&Atilde;&shy;nculos avulsos!&quot; );
									echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;4; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
									return;
								}
								/*
								 *
								 * if(!$this-&gt;verificaSeAtivo($usuario)){
								 * $this-&gt;view-&gt;formMensagem(&quot;-erro&quot;, &quot;Esse usu&Atilde;&iexcl;rio possui um problema quanto ao status!&quot;);
								 * echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;4; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna() . '&quot;&gt;';
								 * return;
								 * }
								 */
								$daqui3Meses = date ( 'Y-m-d', strtotime ( &quot;+60 days&quot; ) ) . 'T' . date ( 'G:00:01' );
								$vinculo-&gt;setFinalValidade ( $daqui3Meses );
								
								if ($vinculoDao-&gt;atualizaValidade ( $vinculo )) {
									$this-&gt;view-&gt;formMensagem ( &quot;-sucesso&quot;, &quot;V&Atilde;&shy;nculo Atualizado com Sucesso!&quot; );
								} else {
									$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Erro ao tentar renovar v&Atilde;&shy;nculo.&quot; );
								}
								echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;2; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
								return;
							}
							
							$this-&gt;view-&gt;formConfirmacaoRenovarVinculo ();
						}
					}
					$this-&gt;view-&gt;formIdentificacao ( $cartao, $usuario, $tipo, $imagem );
				} else {
					$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Cart&Atilde;&pound;o N&Atilde;&pound;o possui V&Atilde;&shy;nculo V&Atilde;&iexcl;lido.&quot; );
				}
			}
		}
	}
	
	/**
	 * Fun&ccedil;&atilde;o utilizada para gerar a tela cadastro.
	 */
	public function telaCadastro() {
		$this-&gt;view-&gt;formBuscaUsuarios ();
		
		if (isset ( $_GET ['selecionado'] )) {
			
			$idDoSelecionado = $_GET ['selecionado'];
			$usuarioDao = new UsuarioDAO ();
			$usuario = new Usuario ();
			$usuario-&gt;setIdBaseExterna ( $idDoSelecionado );
			
			$usuarioDao-&gt;retornaPorIdBaseExterna ( $usuario );
			
			$this-&gt;view-&gt;mostraSelecionado ( $usuario );
			$vinculoDao = new VinculoDAO ();
			
			if (isset ( $_GET ['vinculo_cancelar'] )) {
				$vinculo = new Vinculo ();
				$vinculo-&gt;setId ( $_GET ['vinculo_cancelar'] );
				
				if (isset ( $_POST ['certeza'] )) {
					if ($vinculoDao-&gt;invalidarVinculo ( $vinculo )) {
						$this-&gt;view-&gt;formMensagem ( &quot;-sucesso&quot;, &quot;V&Atilde;&shy;nculo Invalidado.&quot; );
					} else {
						$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Erro ao tentar invalidar v&Atilde;&shy;nculo.&quot; );
					}
					echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;2; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
					return;
				}
				$this-&gt;view-&gt;formConfirmacaoEliminarVinculo ( $vinculo );
				return;
			}
			
			if (isset ( $_GET ['vinculo_renovar'] )) {
				$vinculo = new Vinculo ();
				$vinculo-&gt;setId ( $_GET ['vinculo_renovar'] );
				$vinculoDao-&gt;vinculoPorId ( $vinculo );
				
				$daqui3Meses = date ( 'Y-m-d', strtotime ( &quot;+60 days&quot; ) ) . 'T' . date ( 'G:00:01' );
				$vinculo-&gt;setFinalValidade ( $daqui3Meses );
				
				if (isset ( $_POST ['certeza'] )) {
					if ($vinculoDao-&gt;usuarioJaTemVinculo ( $usuario )) {
						$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Esse usu&Atilde;&iexcl;rio j&Atilde;&iexcl; possui v&Atilde;&shy;nculo v&Atilde;&iexcl;lido.&quot; );
						echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;2; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
						return;
					}
					
					if ($vinculo-&gt;isAvulso ()) {
						$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;N&Atilde;&pound;o existe renova&Atilde;&sect;&Atilde;&pound;o de v&Atilde;&shy;nculos avulsos!&quot; );
						echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;4; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
						return;
					}
					/*
					 * if(!$this-&gt;verificaSeAtivo($usuario)){
					 * $this-&gt;view-&gt;formMensagem(&quot;-erro&quot;, &quot;Esse usu&Atilde;&iexcl;rio possui um problema quanto ao status!&quot;);
					 * echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;4; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna() . '&quot;&gt;';
					 * return;
					 * }
					 */
					if ($vinculoDao-&gt;atualizaValidade ( $vinculo )) {
						$this-&gt;view-&gt;formMensagem ( &quot;-sucesso&quot;, &quot;V&Atilde;&shy;nculo Atualizado com Sucesso!&quot; );
					} else {
						$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Erro ao tentar renovar v&Atilde;&shy;nculo.&quot; );
					}
					echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;4; url=.\?pagina=cartao&amp;selecionado=' . $usuario-&gt;getIdBaseExterna () . '&quot;&gt;';
					return;
				}
				
				$this-&gt;view-&gt;formConfirmacaoRenovarVinculo ();
				return;
			}
			
			$vinculos = $vinculoDao-&gt;retornaVinculosValidosDeUsuario ( $usuario );
			
			$podeComer = $this-&gt;verificaSeAtivo ( $usuario );
			
			if (! $vinculoDao-&gt;usuarioJaTemVinculo ( $usuario ) &amp;&amp; $podeComer) {
				if (! isset ( $_GET ['cartao'] )) {
					echo '&lt;a class=&quot;botao&quot; href=&quot;?pagina=cartao&amp;selecionado=' . $idDoSelecionado . '&amp;cartao=add&quot;&gt;Adicionar&lt;/a&gt;';
				} else {
					$tipoDao = new TipoDAO ( $vinculoDao-&gt;getConexao () );
					$listaDeTipos = $tipoDao-&gt;retornaLista ();
					foreach ( $listaDeTipos as $chave =&gt; $tipo ) {
						if (strtolower ( trim ( $tipo-&gt;getNome () ) ) == 'aluno') {
							if (trim ( $usuario-&gt;getStatusDiscente () ) == 'CADASTRADO' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'ativo' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'ativo - formando' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'formando' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'ativo - graduando') {
								continue;
							}
							unset ( $listaDeTipos [$chave] );
							continue;
						}
						if (strtolower ( trim ( $tipo-&gt;getNome () ) ) == 'servidor tae') {
							
							if (strtolower ( trim ( $usuario-&gt;getStatusServidor () ) ) == 'ativo' &amp;&amp; strpos ( strtolower ( trim ( $usuario-&gt;getCategoria () ) ), 'administrativo' )) {
								continue;
							}
							if ($usuario-&gt;getIDCategoria () == 3) {
								continue;
							}
							unset ( $listaDeTipos [$chave] );
							continue;
						}
						if (strtolower ( trim ( $tipo-&gt;getNome () ) ) == 'servidor docente') {
							if (strtolower ( trim ( $usuario-&gt;getStatusServidor () ) ) == 'ativo' &amp;&amp; strtolower ( trim ( $usuario-&gt;getCategoria () ) ) == 'docente') {
								continue;
							}
							unset ( $listaDeTipos [$chave] );
							continue;
						}
						if (strtolower ( trim ( $tipo-&gt;getNome () ) ) == 'terceirizado') {
							if (strtolower ( trim ( $usuario-&gt;getTipodeUsuario () ) ) == 'terceirizado' || strtolower ( trim ( $usuario-&gt;getTipodeUsuario () ) ) == 'outros') {
								continue;
							}
							unset ( $listaDeTipos [$chave] );
							continue;
						}
						unset ( $listaDeTipos [$chave] );
					}
					
					if (isset ( $_GET ['salvar'] )) {
						foreach ( $listaDeTipos as $tipo ) {
							if ($tipo-&gt;getId () == $_GET ['id_tipo'])
								$esseTipo = $tipo;
						}
						$vinculo = new Vinculo ();
						$daqui3Meses = date ( 'Y-m-d', strtotime ( &quot;+60 days&quot; ) ) . 'T' . date ( 'G:00:01' );
						$vinculo-&gt;setFinalValidade ( $daqui3Meses );
						$vinculo-&gt;getCartao ()-&gt;getTipo ()-&gt;setId ( $esseTipo-&gt;getId () );
						$vinculo-&gt;getCartao ()-&gt;setNumero ( $_GET ['numero_cartao2'] );
						$vinculo-&gt;getResponsavel ()-&gt;setIdBaseExterna ( intval ( $usuario-&gt;getIdBaseExterna () ) );
						$vinculo-&gt;setInicioValidade ( date ( &quot;Y-m-d G:i:s&quot; ) );
						if ($vinculoDao-&gt;usuarioJaTemVinculo ( $vinculo-&gt;getResponsavel () )) {
							$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Esse usu&Atilde;&iexcl;rio j&Atilde;&iexcl; possui cart&Atilde;&pound;o. Inative o cart&Atilde;&pound;o atual para adicionar um novo.&quot; );
							// echo '&lt;a href=&quot;?pagina=cartao&amp;cartaoselecionado=' .$vinculo-&gt;getCartao()-&gt;getId().'&quot;&gt;Clique aqui para ver&lt;/a&gt;';
							return;
						}
						
						if ($vinculoDao-&gt;cartaoTemVinculo ( $vinculo-&gt;getCartao () )) {
							$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;O numero do cart&Atilde;&pound;o digitado j&Atilde;&iexcl; possui vinculo, utilize outro cart&Atilde;&pound;o.&quot; );
							echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;2; url=.\?pagina=cartao&amp;selecionado=' . $vinculo-&gt;getResponsavel ()-&gt;getIdBaseExterna () . '&amp;cartao=add&quot;&gt;';
							return;
						}
						
						if (isset ( $_POST ['enviar_vinculo'] )) {
							
							if ($vinculoDao-&gt;usuarioJaTemVinculo ( $vinculo-&gt;getResponsavel () )) {
								$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Esse usu&Atilde;&iexcl;rio j&Atilde;&iexcl; possui cart&Atilde;&pound;o. Invalide o cart&Atilde;&pound;o atual para adicionar um novo.&quot; );
								// echo '&lt;a href=&quot;?pagina=cartao&amp;cartaoselecionado=' .$vinculo-&gt;getCartao()-&gt;getId().'&quot;&gt;Clique aqui para ver&lt;/a&gt;';
								return;
							}
							
							if ($vinculoDao-&gt;cartaoTemVinculo ( $vinculo-&gt;getCartao () )) {
								$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;O numero do cart&Atilde;&pound;o digitado j&Atilde;&iexcl; possui vinculo, utilize outro cart&Atilde;&pound;o.&quot; );
								return;
							}
							
							if ($vinculoDao-&gt;adicionaVinculo ( $vinculo )) {
								$this-&gt;view-&gt;formMensagem ( &quot;-sucesso&quot;, &quot;Vinculo Adicionado Com Sucesso.&quot; );
							} else {
								$this-&gt;view-&gt;formMensagem ( &quot;-erro&quot;, &quot;Erro na tentativa de Adicionar V&Atilde;&shy;nculo.&quot; );
							}
							echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;10; url=.\?pagina=cartao&amp;selecionado=' . $vinculo-&gt;getResponsavel ()-&gt;getIdBaseExterna () . '&quot;&gt;';
							return;
						}
						
						$this-&gt;view-&gt;formConfirmacaoEnvioVinculo ( $usuario, $_GET ['numero_cartao2'], $esseTipo );
					} else {
						$this-&gt;view-&gt;mostraFormAdicionarVinculo ( $listaDeTipos, $idDoSelecionado );
					}
				}
			}
			
			foreach ( $vinculos as $vinculoComIsencao )
				$vinculoDao-&gt;isencaoValidaDoVinculo ( $vinculoComIsencao );
			$podeRenovar = true;
			if (sizeof ( $vinculos )) {
				$podeRenovar = false;
			}
			$vinculosVencidos = $vinculoDao-&gt;retornaVinculosVencidos ( $usuario );
			$vinculosALiberar = $vinculoDao-&gt;retornaVinculosFuturos ( $usuario );
			
			if (sizeof ( $vinculos )) {
				echo '&lt;h2 class=&quot;titulo&quot;&gt;Vinculos ativos&lt;/h2&gt;';
				$this-&gt;view-&gt;mostraVinculos ( $vinculos );
			}
			
			if (sizeof ( $vinculosVencidos )) {
				echo '&lt;h2 class=&quot;titulo&quot;&gt;Vinculos Vencidos&lt;/h2&gt;';
				$this-&gt;view-&gt;mostraVinculos ( $vinculosVencidos, $podeRenovar );
			}
			
			if (sizeof ( $vinculosALiberar )) {
				echo '&lt;h2 class=&quot;titulo&quot;&gt;Vinculos A Liberar&lt;/h2&gt;';
				$this-&gt;view-&gt;mostraVinculos ( $vinculosALiberar, false );
			}
		}
		
		if (isset ( $_GET ['nome'] )) {
			$usuarioDao = new UsuarioDAO ();
			$listaDeUsuarios = $usuarioDao-&gt;pesquisaNoSigaa ( $_GET ['nome'] );
			if ($listaDeUsuarios == null) {
				
				// ############################# TESTE como root POR ORDEM DO kleber
				$controller = new SincronizadorController ();
				$controller-&gt;sincronizar ();
				// ################################
			}
			$this-&gt;view-&gt;mostraResultadoBuscaDeUsuarios ( $listaDeUsuarios );
			$usuarioDao-&gt;fechaConexao ();
		}
	}
	
	/**
	 * Fun&ccedil;&atilde;o que verificar o status do Usu&aacute;rio.
	 * 
	 * @param Usuario $usuario        	
	 */
	public function verificaSeAtivo(Usuario $usuario) {
		if (strtolower ( trim ( $usuario-&gt;getStatusServidor () ) ) == 'ativo') {
			return true;
		}
		if (trim ( $usuario-&gt;getStatusDiscente () ) == 'CADASTRADO' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'ativo' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'ativo - formando' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'formando' || strtolower ( trim ( $usuario-&gt;getStatusDiscente () ) ) == 'ativo - graduando') {
			return true;
		}
		if (strtolower ( trim ( $usuario-&gt;getTipodeUsuario () ) ) == 'terceirizado' || strtolower ( trim ( $usuario-&gt;getTipodeUsuario () ) ) == 'outros') {
			return true;
		}
		return false;
	}
}

?&gt;
</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>