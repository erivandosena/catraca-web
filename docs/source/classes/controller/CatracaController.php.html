<html>
    <head>
        <script
            type="text/javascript"
            src="../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Classe utilizada para centralizar as demais Classes(DAO, Model, View, Util).
 * Esta classe ser&aacute; instaciada no index.php.
 * 
 * @author Jefferson Uchoa Ponte
 * @version 1.0
 * @copyright UNILAB - Universidade da Integracao Internacional da Lusofonia Afro-Brasileira.
 * @package Controle
 */

class CatracaController {
	private $view;
	public static function main($nivelDeAcesso) {
		switch ($nivelDeAcesso){
			case Sessao::NIVEL_SUPER:
				$controller = new CatracaController ();
				$controller-&gt;controlar ();
				break;
			case Sessao::NIVEL_ADMIN:
				$controller = new CatracaController ();
				$controller-&gt;controlar ();
				break;
			default:
				UsuarioController::main ( $nivelDeAcesso );
				break;
		}
	}
	public function CatracaController() {
		$this-&gt;view = new CatracaView ();
	}
	public function controlar() {
		
		$unidadeDao = new UnidadeDAO ();
		if(!isset($_GET['unidade']) &amp;&amp; !isset($_GET['completo']) &amp;&amp; !isset($_GET['detalhe'])){
			$this-&gt;view-&gt;abreContainer(&quot;Selecione uma Unidade Acad&ecirc;mica&quot;);
			$lista = $unidadeDao-&gt;retornaLista ();
			foreach ($lista as $unidadeAcademica){
				$catracasDessaUnidade = $unidadeDao-&gt;retornaCatracasPorUnidade($unidadeAcademica);
				$i = 0;
				$j = 0;
				foreach ($catracasDessaUnidade as $catracaDessaUnidade){
					$i += $unidadeDao-&gt;totalDeGirosDaCatraca($catracaDessaUnidade);
					$j += $unidadeDao-&gt;totalDeGirosDaCatracaTurnoAtual($catracaDessaUnidade);				
				}
				$this-&gt;view-&gt;mostrarUnidade($unidadeAcademica, count($catracasDessaUnidade) , $i);
				
			}
			$this-&gt;view-&gt;fechaContainer();
		}
		if(isset($_GET['unidade'])){
			$this-&gt;view-&gt;abreContainer();
			
			$unidade = new Unidade();
			$unidade-&gt;setId(intval($_GET['unidade']));
			$listaDeCatracas = $unidadeDao-&gt;retornaCatracasPorUnidade($unidade);
			foreach ($listaDeCatracas as $catraca){
				$valor = $unidadeDao-&gt;totalDeGirosDaCatraca($catraca);
				$outroValor = $unidadeDao-&gt;totalDeGirosDaCatracaTurnoAtual($catraca);
				$this-&gt;view-&gt;mostraCatraca($catraca, $outroValor, $valor);
				
			}
			$this-&gt;view-&gt;fechaContainer();
			
		}else if(isset($_GET['completo'])){
			$this-&gt;view-&gt;abreContainer();
			//Script do Ajax pra atualizar a lista de catracas.
			$listaDeCatracas = $unidadeDao-&gt;retornaCatracasPorUnidade();
			
			foreach ($listaDeCatracas as $catraca){
				$valor = $unidadeDao-&gt;totalDeGirosDaCatraca($catraca);
				$outroValor = $unidadeDao-&gt;totalDeGirosDaCatracaTurnoAtual($catraca);
				$this-&gt;view-&gt;mostraCatraca($catraca, $outroValor, $valor);
				
			}
			$this-&gt;view-&gt;fechaContainer();
		}
		else if(isset($_GET['detalhe'])){
			$catraca = new Catraca();
			$catraca-&gt;setId(intval($_GET['detalhe']));
			$unidadeDao-&gt;preencheCatracaPorId($catraca);
			$valor = $unidadeDao-&gt;totalDeGirosDaCatraca($catraca);
			$outroValor = $unidadeDao-&gt;totalDeGirosDaCatracaTurnoAtual($catraca);
			$this-&gt;view-&gt;detalheCatraca($catraca, $outroValor, $valor);
			
		}
		
		
		
	}
	
}

?&gt;</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>